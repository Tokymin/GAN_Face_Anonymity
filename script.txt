python extract_features.py -v --dataset=celebahq --batch-size=128

/mnt/disk1/toky/Project/GAN_Face_Anonymity/datasets/features/celebahq

python create_fake_dataset.py  --gan stylegan2_ffhq512 --num-samples 16 --cuda

Create a fake image dataset using a pre-trained GAN generator.

options:
  --gan {stylegan2_ffhq1024,stylegan2_ffhq512}


  python pair_nn.py -v --real-dataset celebahq --fake-dataset-root datasets/fake/fake_dataset_stylegan2_ffhq512-0.7-16-CLIP-FaRL-DINO-ArcFace --algorithm auto       --metric euclidean --cuda 

Pair each image of a given real dataset with an image of a given fake dataset

options:
  -h, --help            show this help message and exit
  -v, --verbose         verbose mode on
  --real-dataset {celeba,celebahq,lfw}
                        real dataset
  --fake-dataset-root FAKE_DATASET_ROOT
                        set the fake dataset's root directory (as generated by `create_fake_dataset.py` under datasets/)
  --algorithm {auto,ball_tree,kd_tree,brute,all}
                        set algorithm used to compute the nearest neighbors
  --metric {euclidean,cosine,all}
                        metric to use for distance computation
  --cuda                use CUDA during training
  --no-cuda             do NOT use CUDA during training



python visualize_dataset.py -v --dataset=celebahq --fake-nn-map=datasets/fake/fake_dataset_stylegan2_ffhq512-0.7-16-CLIP-FaRL-DINO-ArcFace/farl_auto_euclidean_nn_map_celebahq.json



invert.py [-h] [-v] --dataset {celeba,celebahq,lfw} [--dataset-root DATASET_ROOT] [--batch-size BATCH_SIZE] [--save-aligned-images] [--dont-save-aligned-images]
                 [--save-reconstructed-images] [--dont-save-reconstructed-images] [--cuda] [--no-cuda]

python invert.py --dataset celebahq --dataset-root /mnt/disk1/toky/Dataset/CelebA-HQ --batch-size 12 --dont-save-aligned-images --save-reconstructed-images --cuda


Real dataset GAN inversion script.

options:
  -h, --help            show this help message and exit
  -v, --verbose         verbose mode on
  --dataset {celeba,celebahq,lfw}
                        choose real dataset
  --dataset-root DATASET_ROOT
                        set dataset root directory
  --batch-size BATCH_SIZE
                        set generation batch size
  --save-aligned-images
                        save aligned images
  --dont-save-aligned-images
                        do NOT save aligned images
  --save-reconstructed-images
                        save reconstructed images
  --dont-save-reconstructed-images
                        do NOT save reconstructed images
  --cuda                use CUDA during training
  --no-cuda             do NOT use CUDA during training




  python visualize_dataset.py -v --dataset=celebahq --fake-nn-map=datasets/fake/fake_dataset_stylegan2_ffhq512-0.7-16-CLIP-FaRL-DINO-ArcFace/farl_auto_euclidean_nn_map_celebahq.json --inv

  anonymize.py [-h] [-v] --dataset {celeba,celebahq,lfw} [--dataset-root DATASET_ROOT] [--subset {train,val,test,train+val,train+val+test}] --fake-nn-map FAKE_NN_MAP
                            [--latent-space {W+,S}] [-m ID_MARGIN] [--epochs EPOCHS] [--optim {sgd,adam}] [--lr LR] [--lr-milestones LR_MILESTONES [LR_MILESTONES ...]]
                            [--lr-gamma LR_GAMMA] [--lambda-id LAMBDA_ID] [--lambda-attr LAMBDA_ATTR] [--cuda] [--no-cuda]

python anonymize.py -v --dataset celebahq --dataset-root /mnt/disk1/toky/Dataset/CelebA-HQ --subset train+val+test --cuda --latent-space  W+ --fake-nn-map datasets/fake/fake_dataset_stylegan2_ffhq512-0.7-16-CLIP-FaRL-DINO-ArcFace/farl_auto_euclidean_nn_map_celebahq.json --epochs 10



python anonymize.py -v --dataset celebahq --dataset-root /mnt/disk1/toky/Dataset/CelebA-HQ --subset test --cuda --latent-space  W+ --fake-nn-map datasets/fake/fake_dataset_stylegan2_ffhq512-0.7-16-CLIP-FaRL-DINO-ArcFace/farl_auto_euclidean_nn_map_celebahq.json --epochs 1


python anonymize.py -v --dataset celebahq --dataset-root /mnt/disk1/toky/Dataset/CelebA-HQ --subset train --cuda --latent-space  W+ --fake-nn-map datasets/fake/fake_dataset_stylegan2_ffhq512-0.7-16-CLIP-FaRL-DINO-ArcFace/farl_auto_euclidean_nn_map_celebahq.json --epochs 1


options:
  -h, --help            show this help message and exit
  -v, --verbose         verbose mode on
  --dataset {celeba,celebahq,lfw}
                        choose real dataset
  --dataset-root DATASET_ROOT
                        set dataset root directory
  --subset {train,val,test,train+val,train+val+test}
                        choose dataset's subset
  --fake-nn-map FAKE_NN_MAP
                        fake NN map file (created by `pair_nn.py`)
  --latent-space {W+,S}
                        StyleGAN2's latent space
  -m ID_MARGIN, --id-margin ID_MARGIN
                        identity loss margin
  --epochs EPOCHS       Number of anonymization steps
  --optim {sgd,adam}    set optimizer ('sgd' or 'adam')
  --lr LR               Learning rate
  --lr-milestones LR_MILESTONES [LR_MILESTONES ...]
                        learning rate scheduler milestones
  --lr-gamma LR_GAMMA   learning rate decay parameter
  --lambda-id LAMBDA_ID
                        Scaling parameter of the ID loss
  --lambda-attr LAMBDA_ATTR
                        Scaling parameter of the attribute loss
  --cuda                use CUDA during training
  --no-cuda             do NOT use CUDA during training

  python visualize_dataset.py -v --dataset=celebahq --fake-nn-map=datasets/fake/fake_dataset_stylegan2_ffhq1024-0.7-60000-CLIP-FaRL-DINO-ArcFace/farl_auto_cosine_nn_map_celebahq.json --inv --anon=datasets/anon/celebahq/celebahq-train+val+test_anon_W+_m-0.5_lambda-id-10.0_lambda-attr-0.1_adam-0.01_epochs-50_farl_auto_cosine_nn_map_celebahq/

  python visualize_dataset.py -v --dataset=celebahq --fake-nn-map=datasets/fake/fake_dataset_stylegan2_ffhq512-0.7-16-CLIP-FaRL-DINO-ArcFace/farl_auto_euclidean_nn_map_celebahq.json --inv --anon=datasets/anon/celebahq/celebahq-test_anon_W+_m-0.0_lambda-id-10.0_lambda-attr-0.1_adam-0.01_epochs-1_farl_auto_euclidean_nn_map_celebahq

  python visualize_dataset.py -v --dataset=celebahq --fake-nn-map=datasets/fake/fake_dataset_stylegan2_ffhq512-0.7-16-CLIP-FaRL-DINO-ArcFace/farl_auto_euclidean_nn_map_celebahq.json --inv --anon=datasets/anon/celebahq/celebahq-train_anon_W+_m-0.0_lambda-id-10.0_lambda-attr-0.1_adam-0.01_epochs-1_farl_auto_euclidean_nn_map_celebahq
